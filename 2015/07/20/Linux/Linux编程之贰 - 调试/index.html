<!DOCTYPE HTML>
<html>

<head>
	<!-- hexo-inject:begin --><!-- hexo-inject:end --><link rel="bookmark" type="image/x-icon" href="/bitbug_favicon_64s.ico" />
	<link rel="shortcut icon" href="/bitbug_favicon_64s.ico">
	
	    <title>
    Cultoy
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="maywzh" />
    
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('https://i.loli.net/2020/03/02/mYeD6WLp3kOy1qw.png') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

	    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="https://cdn.jsdelivr.net/gh/jquery/jquery@1.11.3/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ajlkn/jquery.scrollex@0.2.1/jquery.scrollex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/maywzh/jquery.scrolly@0.0.1/dist/jquery.scrolly.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ajlkn/skel@3.0.1/dist/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
<meta name="generator" content="Hexo 5.1.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_okaidia.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->

<body class="is-loading">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">MAYWZH</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special">
	<ul class="menu links">
		<!-- Homepage  主页  -->
		<li>
			<a href="/" rel="nofollow">Home</a>
		</li>
		<!-- categories_name  分类   -->
		
		<li class="active">
			<a href="#s1">Category</a>
			<ul class="submenu">
				<li>
					<a class="category-link" href="/categories/DevOps/">DevOps</a></li><li><a class="category-link" href="/categories/uncategorized/">uncategorized</a></li><li><a class="category-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></li><li><a class="category-link" href="/categories/%E5%88%B7%E9%A2%98/">刷题</a></li><li><a class="category-link" href="/categories/%E5%9D%91/">坑</a></li><li><a class="category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li><a class="category-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li><li><a class="category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li><li><a class="category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li><a class="category-link" href="/categories/%E6%96%B9%E6%B3%95%E8%AE%BA/">方法论</a></li><li><a class="category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li><li><a class="category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li><a class="category-link" href="/categories/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">系统设计</a></li><li><a class="category-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></li><li><a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">计算机组成原理</a></li><li><a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
			</ul>
		</li>
		
		<!-- archives  归档   -->
		
		<li class="active">
			<a href="#s1">Archive</a>
			<ul class="submenu">
				<li>
					<a class="archive-link" href="/archives/2020/">2020</a></li><li><a class="archive-link" href="/archives/2019/">2019</a></li><li><a class="archive-link" href="/archives/2018/">2018</a></li><li><a class="archive-link" href="/archives/2017/">2017</a></li><li><a class="archive-link" href="/archives/2016/">2016</a></li><li><a class="archive-link" href="/archives/2015/">2015</a>
			</ul>
		</li>
		

		<!-- Pages 自定义   -->
		
		<li>
			<a href="/tags/" title="Tags">
				Tags
			</a>
		</li>
		
		<li>
			<a href="/about/" title="About">
				About
			</a>
		</li>
		


	</ul>
	<!-- icons 图标   -->
	<ul class="icons">
		
		<li>
			<a title="search" href="https://io.maywzh.com" target="_blank" rel="noopener">
				<i class="icon fa fa-search"></i>
			</a>
		</li>
		
		
		<li>
			<a title="twitter" href="https://twitter.com/maywzh" target="_blank" rel="noopener">
				<i class="icon fa fa-twitter"></i>
			</a>
		</li>
		
		<li>
			<a title="github" href="https://github.com/maywzh" target="_blank" rel="noopener">
				<i class="icon fa fa-github"></i>
			</a>
		</li>
		
	</ul>
</nav>

        <div id="main">
            <div class="post_page_title_img"
                style="height: 25rem;background-image: url(https://i.loli.net/2020/08/23/DaNnkXpQMLl9YUG.png);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;">
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;">
                    <h2>实践 Linux 编程之贰 - 调试</h2>
                </a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <p>现代的 IDE 已经提供了相当丰富的调试功能，但有的时候在服务器环境中，我们还是要利用 Linux 的工具来对运行的进程来进行调试和分析。</p>
<a id="more"></a>
<h3><span id="进程调试">进程调试</span></h3><h4><span id="gdb-程序交互调试">gdb 程序交互调试</span></h4><p>GDB 是一个由 GNU 开源组织发布的、UNIX/LINUX 操作系统下的、基于命令行的、功能强大的程序调试工具。</p>
<p>对于一名 Linux 下工作的 c++ 程序员，gdb 是必不可少的工具；</p>
<p>GDB 中的命令固然很多，但我们只需掌握其中十个左右的命令，就大致可以完成日常的基本的程序调试工作。</p>
<p>以下从一个完整的调试过程简单说明最基本的几个命令;</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ gdb programmer     <span class="token comment"># 启动 gdb</span>
<span class="token operator">></span>break main         <span class="token comment"># 设置断点</span>
<span class="token operator">></span>run                <span class="token comment"># 运行调试程序</span>
<span class="token operator">></span>next               <span class="token comment"># 单步调试</span>
<span class="token operator">></span>print var1         <span class="token comment"># 在调试过程中，我们需要查看当前某个变量值的时候，使用 print 命令打印该值</span>
<span class="token operator">></span>list               <span class="token comment"># 显示当前调试处的源代码</span>
<span class="token operator">></span>info b             <span class="token comment"># 显示当前断点设置情况</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>当你完成了第一个程序调试之后，你当然会需要更多的命令：关于 gdb 常用命令及各种调试方法详见 <a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/gdb.html#gdb">gdb 调试利器</a> ;</p>
<p>同时，你需要更高效的调试：常用的调试命令都会有单字符的缩写，使用缩写更方便；同时，直接敲回车表示重复执行上一步命令；这在单步调试时非常有用；</p>
<h4><span id="pstack-跟踪栈空间">pstack 跟踪栈空间</span></h4><p>pstack 是一个脚本工具，可显示每个进程的栈跟踪。pstack 命令必须由相应进程的属主或 root 运行。其核心实现就是使用了 gdb 以及 thread apply all bt 命令;</p>
<p>语法:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pstrack <span class="token operator">&lt;</span>program-pid<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>示例:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ pstack <span class="token number">4551</span>
Thread <span class="token number">7</span> <span class="token punctuation">(</span>Thread <span class="token number">1084229984</span> <span class="token punctuation">(</span>LWP <span class="token number">4552</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x000000302afc63dc in epoll_wait () from /lib64/tls/libc.so.6</span>
<span class="token comment">#1  0x00000000006f0730 in ub::EPollEx::poll ()</span>
<span class="token comment">#2  0x00000000006f172a in ub::NetReactor::callback ()</span>
<span class="token comment">#3  0x00000000006fbbbb in ub::UBTask::CALLBACK ()</span>
<span class="token comment">#4  0x000000302b80610a in start_thread () from /lib64/tls/libpthread.so.0</span>
<span class="token comment">#5  0x000000302afc6003 in clone () from /lib64/tls/libc.so.6</span>
<span class="token comment">#6  0x0000000000000000 in ?? ()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4><span id="strace-分析系统调用">strace 分析系统调用 </span></h4><p>strace 常用来跟踪进程执行时的系统调用和所接收的信号。在 Linux 世界，进程不能直接访问硬件设备，当进程需要访问硬件设备(比如读取磁盘文件，接收网络数据等等) 时，必须由用户态模式切换至内核态模式，通过系统调用访问硬件设备。strace 可以跟踪到一个进程产生的系统调用, 包括参数，返回值，执行消耗的时间。</p>
<p>完整程序:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">strace</span> -o output.txt -T -tt -e <span class="token assign-left variable">trace</span><span class="token operator">=</span>all -p <span class="token number">28979</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>跟踪 28979 进程的所有系统调用（<code>-e trace=all</code>），并统计系统调用的花费时间，以及开始时间（以可视化的时分秒格式显示），最后将记录结果存在 <code>output.txt</code> 文件里面。</p>
<p>查看进程正在做什么(实时输出进程执行系统调用的情况):</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">strace</span> -p <span class="token operator">&lt;</span>process-pid<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>关于 strace 的详细介绍，详见 <a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/strace.html#strace">strace 跟踪进程中的系统调用</a> ;</p>
<h3><span id="目标文件分析">目标文件分析</span></h3><h4><span id="nm-符号清单">nm 符号清单</span></h4><p>nm 用来列出目标文件的符号清单。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ nm myProgrammer
08049f28 d _DYNAMIC
08049ff4 d _GLOBAL_OFFSET_TABLE_
080484dc R _IO_stdin_used
         w _Jv_RegisterClasses
08049f18 d __CTOR_END__
08049f14 d __CTOR_LIST__
08049f20 D __DTOR_END__
08049f1c d __DTOR_LIST__
080485e0 r __FRAME_END__
08049f24 d __JCR_END__
08049f24 d __JCR_LIST__
0804a014 A __bss_start
0804a00c D __data_start
08048490 t __do_global_ctors_aux
08048360 t __do_global_dtors_aux
0804a010 D __dso_handle
         w __gmon_start__
08048482 T __i686.get_pc_thunk.bx
08049f14 d __init_array_end
08049f14 d __init_array_start
08048480 T __libc_csu_fini
08048410 T __libc_csu_init
         U __libc_start_main@@GLIBC_2.0
0804a014 A _edata
0804a01c A _end
080484bc T _fini
080484d8 R _fp_hw
080482b4 T _init
08048330 T _start
0804a014 b completed.6086
0804a00c W data_start
0804a018 b dtor_idx.6088
080483c0 t frame_dummy
080483e4 T main
         U printf@@GLIBC_2.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这些包含可执行代码的段称为正文段。同样地，数据段包含了不可执行的信息或数据。另一种类型的段，称为 BSS 段，它包含以符号数据开头的块。对于 nm 命令列出的每个符号，它们的值使用十六进制来表示（缺省行为），并且在该符号前面加上了一个表示符号类型的编码字符。</p>
<p>常见的各种编码包括：</p>
<ul>
<li>A 表示绝对 (absolute)，这意味着不能将该值更改为其他的连接；</li>
<li>B 表示 BSS 段中的符号；</li>
<li>C 表示引用未初始化的数据的一般符号。</li>
</ul>
<p>可以将目标文件中所包含的不同的部分划分为段。段可以包含可执行代码、符号名称、初始数据值和许多其他类型的数据。有关这些类型的数据的详细信息，可以阅读 UNIX 中 nm 的 man 页面，其中按照该命令输出中的字符编码分别对每种类型进行了描述。</p>
<p>在目标文件阶段，即使是一个简单的 Hello World 程序，其中也包含了大量的细节信息。nm 程序可用于列举符号及其类型和值，但是，要更仔细地研究目标文件中这些命名段的内容，需要使用功能更强大的工具。</p>
<p>其中两种功能强大的工具是 objdump 和 readelf 程序。</p>
<p>注解</p>
<p>关于 nm 工具的参数说明及更多示例详见 <a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/nm.html#nm">nm 目标文件格式分析</a> ;</p>
<h4><span id="objdump-分析二进制文件">objdump 分析二进制文件</span></h4><p>ogjdump 工具用来显示二进制文件的信息，就是以一种可阅读的格式让你更多地了解二进制文件可能带有的附加信息。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ objdump -d myprogrammer
a.out:     <span class="token function">file</span> <span class="token function">format</span> elf32-i386


Disassembly of section .init:

080482b4 <span class="token operator">&lt;</span>_init<span class="token operator">></span>:
 80482b4:   <span class="token number">53</span>                      push   %ebx
 80482b5:   <span class="token number">83</span> ec 08                sub    <span class="token variable">$0x8</span>,%esp
 80482b8:   e8 00 00 00 00          call   80482bd <span class="token operator">&lt;</span>_init+0x<span class="token operator"><span class="token file-descriptor important">9</span>></span>
 80482bd:   5b                      pop    %ebx
 80482be:   <span class="token number">81</span> c3 <span class="token number">37</span> 1d 00 00       <span class="token function">add</span>    <span class="token variable">$0x1d37</span>,%ebx
 80482c4:   8b <span class="token number">83</span> fc ff ff ff       mov    -0x4<span class="token punctuation">(</span>%ebx<span class="token punctuation">)</span>,%eax
 80482ca:   <span class="token number">85</span> c0                   <span class="token builtin class-name">test</span>   %eax,%eax
 80482cc:   <span class="token number">74</span> 05                   je     80482d3 <span class="token operator">&lt;</span>_init+0x1f<span class="token operator">></span>
 80482ce:   e8 3d 00 00 00          call   <span class="token number">8048310</span> <span class="token operator">&lt;</span>__gmon_start__@plt<span class="token operator">></span>
 80482d3:   e8 e8 00 00 00          call   80483c0 <span class="token operator">&lt;</span>frame_dummy<span class="token operator">></span>
 80482d8:   e8 b3 01 00 00          call   <span class="token number">8048490</span> <span class="token operator">&lt;</span>__do_global_ctors_aux<span class="token operator">></span>
 80482dd:   <span class="token number">83</span> c4 08                <span class="token function">add</span>    <span class="token variable">$0x8</span>,%esp
 80482e0:   5b                      pop    %ebx
 80482e1:   c3                      ret

Disassembly of section .plt:
<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>每个可执行代码段将在需要特定的事件时执行，这些事件包括库的初始化和该程序本身主入口点。</p>
<p>对于那些着迷于底层编程细节的程序员来说，这是一个功能非常强大的工具，可用于研究编译器和汇编器的输出。细节信息，比如这段代码中所显示的这些信息，可以揭示有关本地处理器本身运行方式的很多内容。对该处理器制造商提供的技术文档进行深入的研究，您可以收集关于一些有价值的信息，通过这些信息可以深入地了解内部的运行机制，因为功能程序提供了清晰的输出。</p>
<p>注解</p>
<p>关于 objdump 工具的参数说明及更多示例详见 <a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/objdump.html#objdump">objdump 二进制文件分析</a> ;</p>
<h4><span id="readelf-二进制文件分析">readelf 二进制文件分析 </span></h4><p> 这个工具和 objdump 命令提供的功能类似，但是它显示的信息更为具体，并且它不依赖 BFD 库(BFD 库是一个 GNU 项目，它的目标就是希望通过一种统一的接口来处理不同的目标文件）；</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ readelf -all a.out
ELF Header:
  Magic:   7f <span class="token number">45</span> 4c <span class="token number">46</span> 01 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF32
  Data:                              <span class="token number">2</span>'s complement, little endian
  Version:                           <span class="token number">1</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span>
  OS/ABI:                            UNIX - System V
  ABI Version:                       <span class="token number">0</span>
  Type:                              EXEC <span class="token punctuation">(</span>Executable <span class="token function">file</span><span class="token punctuation">)</span>
  Machine:                           Intel <span class="token number">80386</span>
  Version:                           0x1
  Entry point address:               0x8048330
  Start of program headers:          <span class="token number">52</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  Start of section headers:          <span class="token number">4412</span> <span class="token punctuation">(</span>bytes into <span class="token function">file</span><span class="token punctuation">)</span>
  Flags:                             0x0
  Size of this header:               <span class="token number">52</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Size of program headers:           <span class="token number">32</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Number of program headers:         <span class="token number">9</span>
  Size of section headers:           <span class="token number">40</span> <span class="token punctuation">(</span>bytes<span class="token punctuation">)</span>
  Number of section headers:         <span class="token number">30</span>
  Section header string table index: <span class="token number">27</span>

Section Headers:
  <span class="token punctuation">[</span>Nr<span class="token punctuation">]</span> Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
  <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">]</span>                   NULL            00000000 000000 000000 00      <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">0</span>
  <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">]</span> .interp           PROGBITS        08048154 000154 000013 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">1</span>
  <span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">]</span> .note.ABI-tag     NOTE            08048168 000168 000020 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">]</span> .note.gnu.build-i NOTE            08048188 000188 000024 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">]</span> .gnu.hash         GNU_HASH        080481ac 0001ac 000020 04   A  <span class="token number">5</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">]</span> .dynsym           DYNSYM          080481cc 0001cc 000050 <span class="token number">10</span>   A  <span class="token number">6</span>   <span class="token number">1</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span> <span class="token number">6</span><span class="token punctuation">]</span> .dynstr           STRTAB          0804821c 00021c 00004c 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">1</span>
  <span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">]</span> .gnu.version      VERSYM          08048268 000268 00000a 02   A  <span class="token number">5</span>   <span class="token number">0</span>  <span class="token number">2</span>
  <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">]</span> .gnu.version_r    VERNEED         08048274 000274 000020 00   A  <span class="token number">6</span>   <span class="token number">1</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">]</span> .rel.dyn          REL             08048294 000294 000008 08   A  <span class="token number">5</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> .rel.plt          REL             0804829c 00029c 000018 08   A  <span class="token number">5</span>  <span class="token number">12</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> .init             PROGBITS        080482b4 0002b4 00002e 00  AX  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> .plt              PROGBITS        080482f0 0002f0 000040 04  AX  <span class="token number">0</span>   <span class="token number">0</span> <span class="token number">16</span>
  <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> .text             PROGBITS        08048330 000330 00018c 00  AX  <span class="token number">0</span>   <span class="token number">0</span> <span class="token number">16</span>
  <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> .fini             PROGBITS        080484bc 0004bc 00001a 00  AX  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> .rodata           PROGBITS        080484d8 0004d8 000011 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> .eh_frame_hdr     PROGBITS        080484ec 0004ec 000034 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> .eh_frame         PROGBITS        08048520 000520 0000c4 00   A  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> .ctors            PROGBITS        08049f14 000f14 000008 00  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> .dtors            PROGBITS        08049f1c 000f1c 000008 00  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> .jcr              PROGBITS        08049f24 000f24 000004 00  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> .dynamic          DYNAMIC         08049f28 000f28 0000c8 08  WA  <span class="token number">6</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> .got              PROGBITS        08049ff0 000ff0 000004 04  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> .got.plt          PROGBITS        08049ff4 000ff4 000018 04  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> .data             PROGBITS        0804a00c 00100c 000008 00  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> .bss              NOBITS          0804a014 001014 000008 00  WA  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> .comment          PROGBITS        00000000 001014 00002a 01  MS  <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">1</span>
  <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> .shstrtab         STRTAB          00000000 00103e 0000fc 00      <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">1</span>
  <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> .symtab           SYMTAB          00000000 0015ec 000410 <span class="token number">10</span>     <span class="token number">29</span>  <span class="token number">45</span>  <span class="token number">4</span>
  <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> .strtab           STRTAB          00000000 0019fc 0001f9 00      <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">1</span>
  <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ELF Header 为该文件中所有段入口显示了详细的摘要。在列举出这些 Header 中的内容之前，您可以看到 Header 的具体数目。在研究一个较大的目标文件时，该信息可能非常有用。</p>
<p>除了所有这些段之外，编译器可以将调试信息放入到目标文件中，并且还可以显示这些信息。输入下面的命令，仔细分析编译器的输出（假设您扮演了调试程序的角色）:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ readelf --debug-dump a.out <span class="token operator">|</span> <span class="token function">more</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>调试工具，如 GDB，可以读取这些调试信息，并且当程序在调试器中运行的同时，您可以使用该工具显示更具描述性的标记，而不是对代码进行反汇编时的原始地址值。</p>
<p>注解</p>
<p>关于 readelf 工具的参数说明及更多示例详见 <a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/readelf.html#readelf">readelf elf 文件格式分析</a> ;</p>
<h4><span id="size-查看程序内存占用">size 查看程序内存占用</span></h4><p>size 这个工具用来查看程序运行时各个段的实际内存占用:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ size a.out
text           data     bss     dec     hex filename
<span class="token number">1146</span>            <span class="token number">256</span>       <span class="token number">8</span>    <span class="token number">1410</span>     <span class="token number">582</span> a.out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4><span id="file-文件类型查询">file 文件类型查询 </span></h4><p> 这个工具用于查看文件的类型；</p>
<p>比如我们在 64 位机器上发现了一个 32 位的库，链接不上，这就有问题了：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">file</span> a.out
a.out: ELF <span class="token number">64</span>-bit LSB executable, AMD x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, <span class="token keyword">for</span> GNU/Linux <span class="token number">2.6</span>.9, dynamically linked <span class="token punctuation">(</span>uses shared libs<span class="token punctuation">)</span>, <span class="token keyword">for</span> GNU/Linux <span class="token number">2.6</span>.9, not stripped<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>也可以查看 Core 文件是由哪个程序生成:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">file</span> core.22355<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4><span id="strings-查询数据中的文本信息">strings 查询数据中的文本信息 </span></h4><p> 一个文件中包含二进制数据和文本数据，如果只需要查看其文本信息，使用这个命令就很方便；过滤掉非字符数据，将文本信息输出:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ strings <span class="token operator">&lt;</span>objfile<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4><span id="fuser-显示文件使用者">fuser 显示文件使用者 </span></h4><p> 显示所有正在使用着指定的 file, file system 或者 sockets 的进程信息;</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">fuser</span> -m -u redis-server
redis-server: 11552rce<span class="token punctuation">(</span>weber<span class="token punctuation">)</span> 22912rce<span class="token punctuation">(</span>weber<span class="token punctuation">)</span> 25501rce<span class="token punctuation">(</span>weber<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>使用了 <code>-m</code> 和<code>-u</code>选项，用来查找所有正在使用 redis-server 的所有进程的 PID 以及该进程的 OWNER；</p>
<p>fuser 通常被用在诊断系统的”resource busy”问题。如果你希望 kill 所有正在使用某一指定的 file, file system or sockets 的进程的时候，你可以使用 -k 选项:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">fuser</span> –k /path/to/your/filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4><span id="xxd-十六进制显示数据">xxd 十六进制显示数据 </span></h4><p> 以十六进制方式显示文件，只显示文本信息:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$xxd</span> a.out
0000000: 7f45 4c46 0101 0100 0000 0000 0000 0000  .ELF<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
0000010: 0200 0300 0100 0000 <span class="token number">3083</span> 0408 <span class="token number">3400</span> 0000  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0</span><span class="token punctuation">..</span>.4<span class="token punctuation">..</span>.
0000020: 3c11 0000 0000 0000 <span class="token number">3400</span> <span class="token number">2000</span> 0900 <span class="token number">2800</span>  <span class="token operator">&lt;</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.4. <span class="token punctuation">..</span>.<span class="token punctuation">(</span>.
0000030: 1e00 1b00 0600 0000 <span class="token number">3400</span> 0000 <span class="token number">3480</span> 0408  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">4</span><span class="token punctuation">..</span>.4<span class="token punctuation">..</span>.
0000040: <span class="token number">3480</span> 0408 <span class="token number">2001</span> 0000 <span class="token number">2001</span> 0000 0500 0000  <span class="token number">4</span><span class="token punctuation">..</span>. <span class="token punctuation">..</span>. <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
0000050: 0400 0000 0300 0000 <span class="token number">5401</span> 0000 <span class="token number">5481</span> 0408  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>T<span class="token punctuation">..</span>.T<span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4><span id="od-查看特殊格式文件内容">od 查看特殊格式文件内容 </span></h4><p> 通常使用 od 命令查看特殊格式的文件内容。通过指定该命令的不同选项可以以十进制、八进制、十六进制和 ASCII 码来显示文件。</p>
<p>参数说明：</p>
<p><code>-A</code> 指定地址基数，包括：</p>
<ul>
<li>d 十进制</li>
<li>o 八进制（系统默认值）</li>
<li>x 十六进制</li>
<li>n 不打印位移值</li>
</ul>
<p><code>-t</code> 指定数据的显示格式，主要的参数有：</p>
<ul>
<li>c ASCII 字符或反斜杠序列</li>
<li>d 有符号十进制数</li>
<li>f 浮点数</li>
<li>o 八进制（系统默认值为 02）</li>
<li>u 无符号十进制数</li>
<li>x 十六进制数</li>
</ul>
<p>除了选项 c 以外的其他选项后面都可以跟一个十进制数 n，指定每个显示值所包含的字节数。</p>
<p>说明：od 命令系统默认的显示方式是八进制，这也是该命令的名称由来（Octal Dump）。但这不是最有用的显示方式，用 ASCII 码和十六进制组合的方式能提供更有价值的信息输出。</p>
<p>以十六进制和字符同时显示:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ od -Ax -tcx4 a.c
000000   <span class="token comment">#   i   n   c   l   u   d   e       &lt;   s   t   d   i   o   .</span>
              636e6923        6564756c        74733c20        2e6f6964
000010   h   <span class="token operator">></span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>n   <span class="token function">v</span>   o   i   d       m   a   i   n   <span class="token punctuation">(</span>   <span class="token punctuation">)</span>  <span class="token punctuation">\</span>n
              0a0a3e68        64696f76        69616d20        0a29286e
000020   <span class="token punctuation">&#123;</span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>t   i   n   t       i       <span class="token operator">=</span>       <span class="token number">5</span>   <span class="token punctuation">;</span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>t   p
              69090a7b        6920746e        35203d20        70090a3b
000030   r   i   n   t   f   <span class="token punctuation">(</span>   <span class="token string">"h   e   l   l   o   ,   %   d"</span>
              746e6972        <span class="token number">68222866</span>        6f6c6c65        2264252c
000040   ,   i   <span class="token punctuation">)</span>   <span class="token punctuation">;</span>  <span class="token punctuation">\</span>n   <span class="token punctuation">&#125;</span>  <span class="token punctuation">\</span>n
              3b29692c        000a7d0a
000047<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以字符方式显示:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ od -c a.c
0000000   <span class="token comment">#   i   n   c   l   u   d   e       &lt;   s   t   d   i   o   .</span>
0000020   h   <span class="token operator">></span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>n   <span class="token function">v</span>   o   i   d       m   a   i   n   <span class="token punctuation">(</span>   <span class="token punctuation">)</span>  <span class="token punctuation">\</span>n
0000040   <span class="token punctuation">&#123;</span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>t   i   n   t       i       <span class="token operator">=</span>       <span class="token number">5</span>   <span class="token punctuation">;</span>  <span class="token punctuation">\</span>n  <span class="token punctuation">\</span>t   p
0000060   r   i   n   t   f   <span class="token punctuation">(</span>   <span class="token string">"h   e   l   l   o   ,   %   d"</span>
0000100   ,   i   <span class="token punctuation">)</span>   <span class="token punctuation">;</span>  <span class="token punctuation">\</span>n   <span class="token punctuation">&#125;</span>  <span class="token punctuation">\</span>n
0000107<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

            </div>
            <!-- Post Comments -->
            
        </div>
        <!-- Copyright 版权 start -->
        <div id="copyright">
    <ul>
        <li>&copy;Powered By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
        <li>Theme: <a target="_blank" rel="noopener" href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
        <!-- <li><a href="">鄂ICP备2020015912号-1</a></li> -->
    </ul>
    
    <span id="busuanzi_container_site_pv"> 2020 </span>
    
</div>
    </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>





</html>