---
title: TCP三次握手的底层逻辑
categories: 计算机网络
comments: false
thumbnail: 'https://i.loli.net/2020/08/30/dPi5N3M6WpC4xF9.jpg'
cover: 'https://i.loli.net/2020/08/30/dPi5N3M6WpC4xF9.jpg'
date: 2020-09-02 08:31:48
tags:
  - TCP/IP
---

TCP三次握手是基础中的基础，所有工程师都对此熟悉不过。但这里的三次往往被忽视，究竟为何TCP需要三次握手？本文中，我们探讨TCP三次握手的底层逻辑。

这篇文章主要会从以下几个方面介绍为什么我们需要通过三次握手才可以初始化 Sockets、窗口大小、初始序列号并建立 TCP 连接：

- 通过三次握手才能阻止重复历史连接的初始化；
- 通过三次握手才能对通信双方的初始序列号进行初始化；
- 讨论其他次数握手建立连接的可能性；

这几个论点中的第一个是 TCP 选择使用三次握手的最主要原因，其他的几个原因相比之下都是次要的原因，我们在这里对它们的讨论只是为了让整个视角更加丰富，通过多方面理解这一有趣的设计决策。

<!--more-->

[RFC 793 - Transmission Control Protocol](https://tools.ietf.org/html/rfc793) 文档中非常清楚地定义了 TCP 中的连接是什么，我们简单总结一下：用于保证可靠性和流控制机制的信息，包括 Socket、序列号以及窗口大小叫做连接。



![what-is-tcp-connection](https://i.loli.net/2020/09/02/dfQg4A3Y1JqeyTu.png)

所以，建立 TCP 连接就是通信的双方需要对上述的三种信息达成共识，连接中的一对 Socket 是由互联网地址标志符和端口组成的，窗口大小主要用来做流控制，最后的序列号是用来追踪通信发起方发送的数据包序号，接收方可以通过序列号向发送方确认某个数据包的成功接收。

到这里，我们将原有的问题转换成了『为什么需要通过三次握手才可以初始化 Sockets、窗口大小和初始序列号？』，那么接下来我们就开始对这个细化的问题进行分析并寻找解释。

